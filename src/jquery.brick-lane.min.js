/*!
 * Brick Lane v0.0.1
 * Hipstery Cascading Grid Layout Library
 * MIT License
 * by Nicholas Valbusa
 */

(function(e,t){var n="BrickLanePlugin";t.fn.brickLane=function(r){if(typeof r==="string"){var i=t.extend([],arguments);i.shift();for(var s=0,o=this.length;s<o;s++){var u=this[s];var a=t.data(u,n);if(!a){logError("Cannot call "+n+" prior to Brick Lane initialization; "+"options: '"+r+"'");continue}if(!t.isFunction(a[r])||r.charAt(0)==="_"){logError("Method '"+r+"' doesn't exist for "+n);continue}var f=a[r].apply(a,i);if(f!==undefined){return f}}return this}var l=t.extend({columnWidth:"auto",itemSelector:undefined,isResizeBound:true,resizeDelay:200},r);var c=function(n,r){var i=t(n),s=undefined,o=undefined,u=0,a=1,f=[],l=undefined,c=false,h=undefined;_init=function(){if(c){_cleanup()}i.css("overflow","hidden");if(i.css("position")=="static"){i.css("position","relative")}s=r.itemSelector?i.find(r.itemSelector):i.children();if(typeof r.columnWidth==="function"){o=r.columnWidth}else{o=function(){if(r.columnWidth=="auto"){if(s.size()>0){u=s.first().outerWidth()}else{u=300}}else{u=r.columnWidth}return u}}_onViewportResize();if(r.isResizeBound){_bindResize()}c=true},_cleanup=function(){f=[]},_destroy=function(){_unbindResize();i.removeAttr("style");s.each(function(){t(this).removeAttr("style")})},_onViewportResize=function(t){var n=t===undefined?0:r.resizeDelay;if(h){e.clearTimeout(h);delete h}h=e.setTimeout(function(){var e=i.width();if(e!==l){l=e;_setViewportSize();_layoutElements()}},n)},_bindResize=function(){t(e).on("resize",_onViewportResize)},_unbindResize=function(){t(e).off("resize",_onViewportResize)},_addElement=function(e){if(!(e instanceof jQuery)){e=t(e)}e.css("opacity",0);_layoutElement(e,true);_adjustViewportHeight();e.animate({opacity:1},200)},_layoutElements=function(){s.each(function(){_layoutElement(t(this))});_adjustViewportHeight(true)};_layoutElement=function(e,t){var n=1,r=Math.min.apply(Math,f),s=f.indexOf(r),o={x:u*s,y:r};data={left:o.x,top:o.y};if(e.css("position")!=="absolute"){data.position="absolute"}e.css(data);if(t===true){i.append(e)}f[s]+=e.outerHeight(true)},_adjustViewportHeight=function(e){var t=Math.max.apply(Math,f),n=i.outerHeight(true);if(e===true||t>n){i.css("height",t)}};_setViewportSize=function(){var e=o();a=Math.floor(l/e+.01);f=[];for(var t=0;t<a;t++){f.push(0)}};return{initialize:function(){_init()},setOptions:function(e){r=e},appended:function(e){_appendedElement(e)},append:function(e){_addElement(e)},destroy:function(){_destroy()}}};return this.each(function(){var e=t.data(this,n);if(e){e.setOptions(l)}else{e=new c(this,l);t.data(this,n,e)}e.initialize()})}})(window,jQuery)