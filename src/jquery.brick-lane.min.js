(function(e,t){var n="BrickLanePlugin";t.fn.brickLane=function(r){if(typeof r==="string"){var i=t.extend([],arguments);i.shift();for(var s=0,o=this.length;s<o;s++){var u=this[s];var a=t.data(u,n);if(!a){console.debug("Cannot call "+n+" prior to Brick Lane initialization; "+"options: '"+r+"'");continue}if(!t.isFunction(a[r])||r.charAt(0)==="_"){console.debug("Method '"+r+"' doesn't exist for "+n);continue}var f=a[r].apply(a,i);if(f!==undefined){return f}}return this}var l=t.extend({columnWidth:"auto",itemSelector:undefined,isResizeBound:true,resizeDelay:150,transitionDuration:250,useCSS3Transitions:true},r);var c=function(n,r){var i=t(n),s=[],o=undefined,u=0,a=1,f=[],l=undefined,c=false,h=undefined;_init=function(){if(c){_cleanup()}i.css("overflow","hidden");var e=i.css("position");if(e!=="relative"||e!=="absolute"){i.css("position","relative")}var n=r.itemSelector?i.find(r.itemSelector):i.children();n.each(function(){s.push(t(this))});if(typeof r.columnWidth==="function"){o=r.columnWidth}else{o=function(){if(r.columnWidth=="auto"){if(s.length>0){u=s[0].outerWidth()}else{u=300}}else{u=r.columnWidth}return u}}_onViewportResize();if(r.isResizeBound){_bindResize()}c=true},_cleanup=function(){f=[];s=[]},_destroy=function(){_unbindResize();i.removeAttr("style");t.each(s,function(){this.removeAttr("style")})},_onViewportResize=function(t){var n=t===undefined?0:r.resizeDelay;if(h){e.clearTimeout(h);delete h}h=e.setTimeout(function(){var e=i.width();if(e!==l){l=e;_relayoutElements()}},n)},_bindResize=function(){t(e).on("resize",_onViewportResize)},_unbindResize=function(){t(e).off("resize",_onViewportResize)},_addElement=function(e){_appendedElement(e,true)},_appendedElement=function(e,n){n=n===true;if(!(e instanceof jQuery)){e=t(e)}s.push(e);if(n){if(r.transitionDuration>0){e.css("opacity",0)}}_layoutElement(e,n);_adjustViewportHeight();if(n&&r.transitionDuration>0){if(r.useCSS3Transitions){e.css({opacity:1})}else{e.animate({opacity:1},r.transitionDuration)}}},_layoutElements=function(){t.each(s,function(){_layoutElement(this)});_adjustViewportHeight(true)},_layoutElement=function(e,t){var n=1,r=Math.min.apply(Math,f),s=f.indexOf(r),o={left:u*s,top:r};if(e.css("position")!=="absolute"){o.position="absolute"}e.css(o);if(t===true){i.append(e)}f[s]+=e.outerHeight(true)},_relayoutElements=function(){_setViewportSize();_layoutElements()},_adjustViewportHeight=function(e){var t=Math.max.apply(Math,f),n=i.outerHeight(true);if(e===true||t>n){i.css("height",t)}};_setViewportSize=function(){var e=o();a=Math.floor(l/e+.01);f=[];for(var t=0;t<a;t++){f.push(0)}};return{initialize:function(){_init()},setOptions:function(e){r=e},appended:function(e){_appendedElement(e)},append:function(e){_addElement(e)},layout:function(){_relayoutElements()},destroy:function(){_destroy()}}};return this.each(function(){var e=t.data(this,n);if(e){e.setOptions(l)}else{e=new c(this,l);t.data(this,n,e)}e.initialize()})}})(window,jQuery)